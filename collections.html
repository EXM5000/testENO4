<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Collections | Ember & Oak</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Bodoni+Moda:wght@300;400;500;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap"
      rel="stylesheet"
    />
    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        height: 100%;
        font-family: "roboto";
        background-color: #f4f7f2;
        color: #0d0d0d;
        overflow-x: hidden;
      }

      nav {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        background-color: rgba(0, 0, 0, 0);
        color: #fff;
        padding: 40px 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        z-index: 1000;
      }

      nav .logo {
        font-size: 1.3rem;
        font-weight: 400;
        padding-left: 3.5%;
        color: #000000a6;
        font-family: "bodoni moda", serif;
      }

      nav ul {
        list-style: none;
        margin: 0;
        padding: 0;
        display: flex;
        gap: 20px;
        padding-right: 5%;
      }

      nav ul li a {
        font-family: "bodoni moda", serif;
        color: #000000a6;
        text-decoration: none;
        font-size: 1rem;
        transition: color 0.3s ease;
      }

      .nav-cart a {
        display: flex;
        align-items: center;
        gap: 5px;
        font-size: 1.1rem;
        color: #ffffffa6;
        text-decoration: none;
        position: relative;
      }

      #nav-cart-count {
        background: #ffffffa6;
        color: #000000;
        font-size: 0.8rem;
        font-weight: bold;
        padding: 0px 4px;
        border-radius: 50%;
        position: absolute;
        top: -8px;
        right: -10px;
      }

      main {
        padding-top: 140px;
        max-width: 700px;
        margin: 0 auto;
        text-align: left;
      }

      h1 {
        font-size: 2.62rem;
        font-weight: 400;
        margin-bottom: 40px;
        color: #0d0d0d;
        text-align: center;
      }

      ul#cart-list {
        list-style: none;
        padding: 0;
        margin: 0;
        border-top: 1px solid rgba(0, 0, 0, 0.1);
      }

      li.cart-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 18px 0;
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      }

      .item-details {
        display: flex;
        flex-direction: column;
      }

      .item-name {
        font-size: 1.3rem;
        margin-bottom: 5px;
      }

      .item-price {
        color: rgba(0, 0, 0, 0.6);
        font-size: 0.9rem;
      }

      .item-controls {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      input.item-qty {
        width: 50px;
        text-align: center;
        font-family: inherit;
        font-size: 1rem;
        border: 1px solid rgba(0, 0, 0, 0.2);
        background: transparent;
        border-radius: 4px;
        color: #0d0d0d;
        padding: 4px;
      }

      button.remove-btn {
        background: none;
        border: 1px solid rgba(0, 0, 0, 0.3);
        border-radius: 6px;
        color: #0d0d0d;
        padding: 5px 10px;
        cursor: pointer;
        font-family: inherit;
        font-size: 0.9rem;
        transition: background-color 0.2s ease;
      }

      button.remove-btn:hover {
        background-color: rgba(0, 0, 0, 0.05);
      }

      .cart-summary {
        margin-top: 30px;
        text-align: right;
        font-size: 1.1rem;
      }

      .checkout-btn {
        display: inline-block;
        margin-top: 25px;
        padding: 12px 25px;
        border: 1px solid #0d0d0d;
        color: #0d0d0d;
        background: transparent;
        border-radius: 10px;
        font-family: inherit;
        font-size: 1rem;
        cursor: pointer;
        transition: background-color 0.3s ease;
      }

      .checkout-btn:hover {
        background-color: rgba(0, 0, 0, 0.1);
      }

      .search-bar {
        width: 100%;
        max-width: 400px;
        padding: 10px 15px;
        border: 1px solid rgba(0, 0, 0, 0.2);
        border-radius: 8px;
        font-size: 1rem;
        outline: none;
        display: block;
        margin: 120px auto 20px;
        transition: all 0.2s ease;
      }

      .search-bar:focus {
        border-color: #0d0d0d;
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
      }

      @media (max-width: 600px) {
        .image-dots {
          display: flex;
          justify-content: center;
          gap: 8px;
          margin-top: 8px;
        }
        .image-dot {
          width: 10px;
          height: 10px;
          border-radius: 50%;
          background-color: rgba(0, 0, 0, 0.3);
          cursor: pointer;
          transition: background-color 0.3s ease;
        }
        .image-dot.active {
          background-color: #0d0d0d;
        }
        li.cart-item {
          flex-direction: column;
          align-items: flex-start;
          gap: 10px;
        }
        .item-controls {
          width: 100%;
          justify-content: space-between;
        }
        main {
          padding: 120px 20px 60px;
        }
      }

      /* Product section and card styles */
      .product {
        padding: 25px 10%;
        text-align: center;
        background-color: #f4f7f2;
      }

      .product-cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 40px;
        justify-content: center;
        margin-top: 50px;
      }

      .card {
        background-color: #ffffff;
        border: 1px solid rgba(0, 0, 0, 0.1);
        border-radius: 12px;
        padding: 25px 20px;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        align-items: center;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        transition: opacity 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease;
        cursor: pointer;
      }
      /* --- MODAL STYLES --- */
      .modal-backdrop {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(20, 20, 20, 0.68);
        z-index: 2000;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: opacity 0.3s ease;
        opacity: 0;
        pointer-events: none;
      }
      .modal-backdrop.open {
        opacity: 1;
        pointer-events: auto;
      }
      .candle-modal {
        background: #fff;
        border-radius: 18px;
        max-width: 410px;
        width: 92vw;
        max-height: 95vh;
        box-shadow: 0 8px 38px rgba(0, 0, 0, 0.18);
        display: flex;
        flex-direction: column;
        position: relative;
        padding: 0 0 32px 0;
        animation: modalIn 0.33s cubic-bezier(0.4, 1.6, 0.5, 1) forwards;
        opacity: 0;
        transform: scale(0.9);
        overflow: hidden;
      }
      .modal-backdrop.open .candle-modal {
        opacity: 1;
        transform: scale(1);
        transition: opacity 0.25s, transform 0.25s;
      }
      @keyframes modalIn {
        from {
          opacity: 0;
          transform: scale(0.9);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }
      .candle-modal-close {
        position: absolute;
        top: 12px;
        right: 16px;
        font-size: 1.62rem;
        color: #333;
        background: none;
        border: none;
        cursor: pointer;
        z-index: 11;
        padding: 0;
        transition: color 0.18s;
      }
      .candle-modal-close:hover {
        color: #a41b1b;
      }
      .candle-modal-img-wrap {
        width: 100%;
        height: 310px;
        /* overflow-x: auto; */
        overflow-y: hidden;
        border-radius: 16px 16px 0 0;
        background: #f4f7f2;
        display: flex;
        align-items: stretch;
        justify-content: flex-start;
        /* gap: 8px; */
        /* scroll-behavior: smooth; */
      }
      .candle-modal-img {
        flex: 0 0 100%;
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 16px 16px 0 0;
        display: block;
      }
      .candle-modal-content {
        padding: 28px 28px 0 28px;
        overflow-y: auto;
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        min-height: 0;
      }
      .candle-modal-desc {
        font-size: 1.01rem;
        color: #444;
        margin-bottom: 16px;
        line-height: 1.5;
      }
      .candle-modal-notes {
        font-size: 0.9rem;
        color: #444444b4;
        margin-bottom: 18px;
        font-style: italic;
      }
      .candle-modal-price {
        font-size: 1.3rem;
        color: #222;
        font-weight: 500;
        margin-bottom: 18px;
      }
      .candle-modal-addcart {
        display: inline-block;
        padding: 10px 28px;
        border: 1px solid #0d0d0d;
        border-radius: 8px;
        background: transparent;
        color: #0d0d0d;
        font-family: "roboto";
        font-size: 1rem;
        text-decoration: none;
        transition: background-color 0.3s, color 0.3s;
        cursor: pointer;
        margin-top: 6px;
      }
      .candle-modal-addcart:hover {
        background-color: #0d0d0d;
        color: #f4f7f2;
      }
      @media (max-width: 600px) {
        .candle-modal {
          max-width: 99vw;
          width: 99vw;
          padding: 0 0 16px 0;
        }
        .candle-modal-content {
          padding: 18px 12px 0 12px;
        }
        .candle-modal-img-wrap {
          height: 160px;
        }
        .candle-modal-img {
          border-radius: 12px 12px 0 0;
        }
      }

      .card-image {
        width: 100%;
        height: 260px;
        object-fit: cover;
        border-radius: 8px;
        margin-bottom: 20px;
      }

      .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
      }

      .card-title {
        font-family: "bodoni moda", serif;
        font-size: 1.62rem;
        font-weight: 400;
        color: #0d0d0d;
        margin-bottom: 20px;
        line-height: 1.6em;       /* height of one line */
        min-height: 3.2em;        /* 2 lines = 2 * line-height */
        display: flex;
        align-items: flex-start;
        overflow: hidden;
        white-space: normal;
      }

      .candle-modal-title {
        font-family: "bodoni moda", serif;
        font-size: 1.62rem;
        font-weight: 400;
        color: #0d0d0d;
        margin-bottom: 20px;
        line-height: 1.6em;
        white-space: normal;
      }
      
      .card-description {
        font-family: "roboto";
        font-size: 0.9rem;
        color: rgba(0, 0, 0, 0.7);
        line-height: 1.5;
        margin-bottom: 25px;
      }

      .card-button {
        border: none;
        background: transparent;
        color: #0d0d0dc2;
        font-weight: bold;
        text-decoration: underline;
        box-shadow: none;
        font-family: "roboto";
      }
      .card-button:hover {
        color: #222;
        text-decoration: underline wavy;
        background: transparent;
      }

      .card-button.view-details {
        display: inline-block;
        padding: 10px 25px;
        border: 1px solid #0d0d0d;
        border-radius: 8px;
        background: transparent;
        color: #0d0d0d;
        font-family: "roboto";
        font-size: 1rem;
        text-decoration: none;
        transition: background-color 0.3s ease, color 0.3s ease;
        font-weight: 400;
        margin-bottom: 10px;
      }

      .card-button.view-details:hover,
      .card-button.view-details:focus {
        background-color: #0d0d0d;
        color: #f4f7f2;
      }

      @media (max-width: 600px) {
        .card {
          padding: 30px 15px;
        }
        .card-title {
          font-size: 1rem;
        }
      }

      /* Footer styles */
      .footer {
        background-color: #0d0d0d;
        color: #f4f7f2;
        padding: 80px 10%;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 40px;
        text-align: left;
      }

      .footer h3 {
        margin-bottom: 15px;
        font-weight: 400;
        color: #f4f7f2;
      }

      .footer p {
        line-height: 1.6;
        color: #ffffffc9;
      }

      .footer-column {
        max-width: 15vw;
      }

      .footer-column a {
        display: block;
        color: #ffffffc9;
        text-decoration: none;
        margin: 6px 0;
        transition: color 0.3s ease;
      }

      .footer-column a:hover {
        color: #fff;
      }

      .footer-contact i {
        margin-right: 8px;
      }

      .newsletter-form input[type="email"] {
        padding: 10px 15px;
        border-radius: 8px;
        border: 1px solid #fff;
        background: transparent;
        color: #fff;
        font-family: inherit;
        font-size: 1rem;
        margin-bottom: 10px;
        width: 100%;
      }

      .newsletter-form button {
        padding: 10px 25px;
        border-radius: 8px;
        border: 1px solid #fff;
        background: transparent;
        color: #fff;
        font-family: inherit;
        font-size: 1rem;
        cursor: pointer;
        transition: background-color 0.3s ease, color 0.3s ease;
      }

      .newsletter-form button:hover {
        background-color: rgba(255, 255, 255, 0.1);
      }

      .footer-bottom {
        grid-column: 1 / -1;
        text-align: center;
        margin-top: 60px;
        font-size: 0.9rem;
        color: #ffffff99;
      }

      .payment-icons {
        display: flex;
        align-items: center;
        gap: 8px;
        list-style: none;
        padding: 0;
        margin: 0;
        justify-content: center;
      }

      .payment-icon {
        width: 60px;
        height: 36px;
        display: inline-block;
      }

      .placeholder {
        height: 15vh;
      }

      .candle-modal-sizeburn {
        font-size: 1rem;
        color: #444444b4;
        margin-bottom: 12px;
      }
    </style>
  </head>
  <body>
    <nav>
      <div class="logo">
        <a href="index.html" style="text-decoration: none; color: inherit"
          >Ember & Oak</a
        >
      </div>
      <ul>
        <li><a href="Text/Story.html">About</a></li>
        <li><a href="Text/Ethos.html">Contact</a></li>
        <li><a href="collections.html">Collections</a></li>
        <li><a href="Text/CandleCare.html">Tending</a></li>
        <li class="nav-cart">
          <a href="Functionality/cart.html" id="nav-cart-button">
            🛒 <span id="nav-cart-count">0</span>
          </a>
        </li>
      </ul>
    </nav>

    <input
      type="text"
      id="searchInput"
      placeholder="Search collections..."
      class="search-bar"
    />

    <section class="product">
      <p
        style="
          text-align: center;
          font-size: 1rem;
          color: rgba(0, 0, 0, 0.7);
          margin-bottom: 15px;
        "
      >
        Customize your experience! Unscented or fusion candles available upon
        request.
      </p>
      <div id="collections-root"></div>
    </section>

  <!-- Footer Section -->
  <footer class="footer">
    <!-- Column 1 -->
    <div class="footer-column">
      <h3>Ember & Oak</h3>
      <p>We create candles designed around emotion — blending natural ingredients with timeless design for moments of calm and connection.</p>
    </div>
  
    <!-- Column 2 -->
    <div class="footer-column">
      <h3>Browse</h3>
      <a href="#header">Home</a>
      <a href="collections.html">Collections</a>
      <a href="Text/Story.html">Our Story</a>
      <a href="Text/Ethos.html">Contact</a>
      <a href="Text/CandleCare.html">Candle Care</a>
    </div>
  
    <!-- Column 3 -->
    <div class="footer-column footer-contact">
      <h3>Contact</h3>
      <p><i>✉️</i> info@eandoak.ca</p>
    </div>
  
    <!-- Column 4 -->
    <div class="footer-column newsletter">
      <h3 class="newsletterTitle">Be the first to get your hands on new scents!</h3>
      <form action="https://eandoak.us3.list-manage.com/subscribe/post?u=0a965ac48983e8ae55ae3ab49&amp;id=29e2e20e94&amp;f_id=000aa6e0f0" 
            method="post" class="newsletter-form" target="_blank">
        <input type="email" name="EMAIL" placeholder="Enter your email" required>
        <button type="submit">Subscribe</button>
      </form>
    </div>
  
    <div class="footer-bottom">
      <div class="footer-bottom-container" style="display:flex; flex-wrap:wrap; justify-content:space-between; align-items:center; gap:12px;">
        <div class="footer-copyright" style="color:#ffffff99; font-size:0.9rem;">
          Secure payments by Square &nbsp; | &nbsp; © 2025 Evan Mottley and Ember & Oak. All rights reserved.
        </div>
        <div class="footer-payment-methods">
          <ul class="payment-icons">
            <li>
              <svg class="payment-icon" viewBox="0 0 38 24" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Visa">
                <rect width="38" height="24" rx="4" fill="white"/>
                <text x="6" y="16" font-family="Arial, sans-serif" font-weight="bold" font-size="10" fill="#1A1F71">VISA</text>
              </svg>
            </li>
            <li>
              <svg class="payment-icon" viewBox="0 0 38 24" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Mastercard">
                <rect width="38" height="24" rx="4" fill="white"/>
                <circle cx="16" cy="12" r="6" fill="#EB001B"/>
                <circle cx="22" cy="12" r="6" fill="#F79E1B"/>
              </svg>
            </li>
            <li>
              <svg class="payment-icon" viewBox="0 0 38 24" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="American Express">
                <rect width="38" height="24" rx="4" fill="white"/>
                <text x="4" y="15" font-family="Arial, sans-serif" font-weight="bold" font-size="7" fill="#2E77BC">AMEX</text>
              </svg>
            </li>
            <li>
              <svg class="payment-icon" viewBox="0 0 38 24" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Discover">
                <rect width="38" height="24" rx="4" fill="white"/>
                <text x="4" y="15" font-family="Arial, sans-serif" font-weight="bold" font-size="7" fill="#FF6F00">DISCOVER</text>
              </svg>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </footer>

    <script src="https://cdn.jsdelivr.net/npm/fuse.js@7.0.0"></script>
    <script>
      // --- CANDLE DATA ---
      const candleCollections = [
        {
          name: "The Holiday Collection",
          candles: [
            {
              name: "Okanagan Vinyard",
              image: "https://source.unsplash.com/400x300/?candle,light",
              price: 19.99,
              shortDescription:
                "A crisp, earthy scent inspired by rolling vineyards and golden sunlight.",
              longDescription:
                "Inspired by the sun-drenched slopes of the Okanagan, this candle blends fresh grape, green leaves, and subtle oak for a sophisticated, invigorating fragrance.",
              scentNotes:
                "Top: Orange Peel, Cinnamon, Lemon<br>Mid: Cranberry, Red Currant, Apple Cider<br>Base: Red Wine, Wood",
              size: "6oz",
              burnTime: "~35 hours",
            },
            {
              name: "Midnight Embers",
              image: "https://source.unsplash.com/400x300/?flame,dark",
              price: 19.99,
              shortDescription:
                "Warm, smoky notes with hints of amber and spice — perfect for quiet nights.",
              longDescription:
                "Let the night settle in with this cozy blend of charred woods, golden amber, and a whisper of spice. Ideal for relaxing by the fire.",
              scentNotes:
                "Top: Bergamont, Hemp<br>Mid: Peppercorn, Rum, Patchouli<br>Base: Sandalwood, Leather",
              size: "6oz",
              burnTime: "~35 hours",
            },
            {
              name: "Velvet Plum",
              image: "https://source.unsplash.com/400x300/?plum,glass",
              price: 19.99,
              shortDescription:
                "Deep, fruity tones with a touch of sweetness for a soft, elegant atmosphere.",
              longDescription:
                "Lush plum, dark berries, and a hint of vanilla create a plush, inviting scent that fills your space with warmth and luxury.",
              scentNotes:
                "Top: Citrus<br>Mid: Plum, Black Cherry<br>Base: Sugar, Light Musk, Amber, Freesia, Vanilla",
              size: "6oz",
              burnTime: "~35 hours",
            },
            {
              name: "Fraser Fir",
              image: "https://source.unsplash.com/400x300/?fir,forest",
              price: 19.99,
              shortDescription:
                "Fresh, forest-inspired aroma reminiscent of evergreen mornings.",
              longDescription:
                "Capture the crispness of a winter forest with this blend of fir needles, pine, and cool cedarwood. Refreshing and grounding.",
              scentNotes:
                "Top: Cypress, Lemon Peel<br>Mid: Evergreen, Cedar<br>Base: Fir, Amber, Moss",
              size: "6oz",
              burnTime: "~35 hours",
            },
          ],
        },
        {
          name: "The Autumn Collection",
          candles: [
            {
              name: "Apple Ginger Spritz",
              image: "https://source.unsplash.com/400x300/?candle,light",
              price: 19.99,
              shortDescription:
                "A crisp, earthy scent inspired by rolling vineyards and golden sunlight.",
              longDescription:
                "Juicy apple and zesty ginger come together for a sparkling, uplifting autumn fragrance. A spirited twist on a classic orchard scent.",
              scentNotes:
                "Notes: Red apple, fresh ginger, sparkling citrus, cinnamon.",
              size: "6oz",
              burnTime: "~35 hours",
            },
            {
              name: "Pumpkin Spice Buttercream",
              image: "https://source.unsplash.com/400x300/?flame,dark",
              price: 19.99,
              shortDescription:
                "Warm, smoky notes with hints of amber and spice — perfect for quiet nights.",
              longDescription:
                "Creamy butter, spiced pumpkin, and brown sugar evoke the comfort of autumn baking and cozy gatherings.",
              scentNotes:
                "Notes: Pumpkin, cinnamon, nutmeg, vanilla buttercream.",
              size: "6oz",
              burnTime: "~35 hours",
            },
            {
              name: "Butterscotch & Bourbon",
              image: "https://source.unsplash.com/400x300/?plum,glass",
              price: 19.99,
              shortDescription:
                "Deep, fruity tones with a touch of sweetness for a soft, elegant atmosphere.",
              longDescription:
                "Rich butterscotch melds with smoky bourbon and a hint of toasted oak for a decadent, warming aroma.",
              scentNotes: "Notes: Butterscotch, bourbon, caramel, toasted oak.",
              size: "6oz",
              burnTime: "~35 hours",
            },
            {
              name: "Caramel Latté",
              image: "https://source.unsplash.com/400x300/?fir,forest",
              price: 19.99,
              shortDescription:
                "Fresh, forest-inspired aroma reminiscent of evergreen mornings.",
              longDescription:
                "A creamy blend of roasted coffee, sweet caramel, and vanilla, reminiscent of your favorite fall café treat.",
              scentNotes: "Notes: Espresso, caramel, vanilla, steamed milk.",
              size: "6oz",
              burnTime: "~35 hours",
            },
          ],
        },
        {
          name: "The Signature Collection",
          candles: [
            {
              name: "Pineapple & Sage",
              image: "img/Products/signatureCollection/101sm.webp",
              price: 19.99,
              shortDescription:
                "A crisp, earthy scent inspired by rolling vineyards and golden sunlight.",
              longDescription:
                "Tropical pineapple and fresh sage combine in a bright, herbaceous fragrance that refreshes and uplifts.",
              scentNotes: "Notes: Pineapple, sage, green leaves, sugarcane.",
              size: "6oz",
              burnTime: "~35 hours",
            },
            {
              name: "Wild Lavender",
              image: "img/Products/signatureCollection/102sm.webp",
              price: 19.99,
              shortDescription:
                "Warm, smoky notes with hints of amber and spice — perfect for quiet nights.",
              longDescription:
                "Relax with wild lavender, soft musk, and a hint of sandalwood for a tranquil, spa-like experience.",
              scentNotes: "Notes: Lavender, sandalwood, musk, bergamot.",
              size: "6oz",
              burnTime: "~35 hours",
            },
            {
              name: "Smoked Sandalwood",
              image: "img/Products/signatureCollection/104sm.webp",
              price: 19.99,
              shortDescription:
                "Deep, fruity tones with a touch of sweetness for a soft, elegant atmosphere.",
              longDescription:
                "Earthy sandalwood and gentle smoke are layered with creamy vanilla for a balanced, soothing scent.",
              scentNotes: "Notes: Sandalwood, smoke, vanilla, amber.",
              size: "6oz",
              burnTime: "~35 hours",
            },
            {
              name: "Creamy Vanilla",
              image: "img/Products/signatureCollection/103sm.webp",
              price: 19.99,
              shortDescription:
                "Fresh, forest-inspired aroma reminiscent of evergreen mornings.",
              longDescription:
                "Classic, rich vanilla with a touch of cream and sugar for a warm, comforting fragrance.",
              scentNotes: "Notes: Vanilla bean, cream, sugar, soft woods.",
              size: "6oz",
              burnTime: "~35 hours",
            },
          ],
        },
      ];

      // --- RENDER COLLECTIONS ---
      function renderCollections(collections) {
        const root = document.getElementById("collections-root");
        root.innerHTML = "";
        collections.forEach((collection) => {
          // Section Title
          const sectionHeader = document.createElement("h1");
          sectionHeader.className = "productHeader";
          sectionHeader.textContent = collection.name;
          root.appendChild(sectionHeader);

          // Card grid
          const grid = document.createElement("div");
          grid.className = "product-cards";

          collection.candles.forEach((candle, idx) => {
            const card = document.createElement("div");
            card.className = "card";
            card.setAttribute("data-price", candle.price);
            card.setAttribute("data-candle-name", candle.name);
            card.setAttribute("tabindex", "0");

            // Insert line break at the first space in the name for the card title only
            const splitName = candle.name.replace(' ', '<br>');

            card.innerHTML = `
            <img src="${candle.image}" alt="${candle.name}" class="card-image">
            <div class="card-title">${splitName}</div>
            <p class="card-description">${candle.shortDescription}</p>
            <a href="#" class="card-button view-details">View Details</a>
            <button class="card-button add-to-cart">Add to Cart</button>
          `;
            // Store full candle data for modal via dataset (stringify)
            card.dataset.candleInfo = JSON.stringify(candle);
            grid.appendChild(card);
          });
          root.appendChild(grid);
        });
      }

      // --- MODAL LOGIC ---
      // Persistent Escape key handler for modal
      (function () {
        // Only add once
        let escHandlerAttached = false;
        function persistentEscHandler(e) {
          if (e.key === "Escape") closeCandleModal();
        }
        window._candleModalEscHandler = persistentEscHandler;
        if (!escHandlerAttached) {
          document.addEventListener("keydown", persistentEscHandler);
          escHandlerAttached = true;
        }
      })();

      // Remove any existing modal in DOM
      function closeCandleModal() {
        const backdrop = document.querySelector(".modal-backdrop");
        if (backdrop) {
          backdrop.classList.remove("open");
          setTimeout(() => {
            if (backdrop.parentNode) backdrop.parentNode.removeChild(backdrop);
          }, 250);
        }
        // Always restore body scroll
        document.body.style.overflow = "";
      }

      function openCandleModal(candle) {
        closeCandleModal(); // Remove any existing
        // Modal markup
        const backdrop = document.createElement("div");
        backdrop.className = "modal-backdrop";
        backdrop.innerHTML = `
        <div class="candle-modal"
          data-candle-name="${candle.name.replace(/"/g, "&quot;")}"
          data-candle-price="${candle.price}">
          <button class="candle-modal-close" aria-label="Close">&times;</button>
          <div class="candle-modal-img-wrap">
            <img src="${candle.image}" alt="${candle.name}" class="candle-modal-img" />
          </div>
          <div class="candle-modal-content">
            <div class="candle-modal-title">${candle.name}</div>
            <div class="candle-modal-sizeburn">Size: ${
              candle.size || "6oz"
            } | Burn Time: ${candle.burnTime || "~35 hours"}</div>
            <div class="candle-modal-desc">${candle.longDescription}</div>
            <div class="candle-modal-notes">${candle.scentNotes}</div>
            <div class="candle-modal-price">$${candle.price.toFixed(2)}</div>
            <button href="#" class="candle-modal-addcart">Add to Cart</button>
          </div>
        </div>
      `;
        document.body.appendChild(backdrop);
        // --- Attach modal add-to-cart button directly ---
        const modalAddBtn = backdrop.querySelector(".candle-modal-addcart");
        if (modalAddBtn) {
          modalAddBtn.addEventListener("click", function (e) {
            e.preventDefault();
            addToCart(candle.name, candle.price);
            modalAddBtn.textContent = "Added!";
            modalAddBtn.disabled = true;
            setTimeout(() => {
              modalAddBtn.textContent = "Add to Cart";
              modalAddBtn.disabled = false;
            }, 1000);
          });
        }
        setTimeout(() => {
          backdrop.classList.add("open");
        }, 10);
        document.body.style.overflow = "hidden";
        // --- Begin image dots logic (if you have multiple images, currently only one) ---
        // No-op if only one image; original code for dots omitted for brevity
        // --- End image dots logic ---
        // Close handlers
        // Close on X button
        backdrop.querySelector(".candle-modal-close").addEventListener("click", closeCandleModal);
        // Close on backdrop click (outside modal)
        backdrop.addEventListener("mousedown", function (e) {
          if (e.target === backdrop) closeCandleModal();
        });
        // Trap focus
        const modal = backdrop.querySelector(".candle-modal");
        setTimeout(() => {
          if (modal) modal.focus && modal.focus();
        }, 100);
      }

      // --- CLICK-TO-MODAL LOGIC ---
      function attachExpandCards() {
        document.querySelectorAll(".card").forEach((card) => {
          // Remove any prior listeners
          card.removeEventListener("click", card._expandHandler || (() => {}));
          card.removeEventListener(
            "keydown",
            card._expandKeyHandler || (() => {})
          );
          // Handler for modal open on card (except button)
          card._expandHandler = function (e) {
            // If clicking the view details button, open modal (allow)
            if (e.target.closest(".card-button.view-details")) {
              // Get candle info from dataset
              let candle = null;
              try {
                candle = JSON.parse(card.dataset.candleInfo);
              } catch (e) {}
              if (!candle) return;
              openCandleModal(candle);
              e.preventDefault();
              return;
            }
            // Don't open if clicking another card-button (shouldn't be any)
            if (e.target.closest(".card-button")) return;
            // Get candle info from dataset
            let candle = null;
            try {
              candle = JSON.parse(card.dataset.candleInfo);
            } catch (e) {}
            if (!candle) return;
            openCandleModal(candle);
          };
          card._expandKeyHandler = function (e) {
            // Open modal on Enter/Space key (unless focus is on button)
            if (
              (e.key === "Enter" || e.key === " ") &&
              !e.target.closest(".card-button")
            ) {
              e.preventDefault();
              card._expandHandler(e);
            }
          };
          card.addEventListener("click", card._expandHandler);
          card.addEventListener("keydown", card._expandKeyHandler);
        });
        // Attach click to all "View Details" buttons, just in case user tabs to them
        document
          .querySelectorAll(".card-button.view-details")
          .forEach((btn) => {
            btn.removeEventListener(
              "click",
              btn._viewDetailsHandler || (() => {})
            );
            btn._viewDetailsHandler = function (e) {
              const card = btn.closest(".card");
              if (!card) return;
              let candle = null;
              try {
                candle = JSON.parse(card.dataset.candleInfo);
              } catch (e) {}
              if (!candle) return;
              openCandleModal(candle);
              e.preventDefault();
            };
            btn.addEventListener("click", btn._viewDetailsHandler);
          });
      }

      // --- SEARCH FUNCTIONALITY ---
      let fuse,
        allProducts = [];
      function setupSearch() {
        const searchInput = document.getElementById("searchInput");
        // Gather all card DOM elements and names
        allProducts = [];
        document.querySelectorAll(".card").forEach((card) => {
          allProducts.push({
            name: card.querySelector(".card-title").textContent,
            element: card,
          });
        });
        fuse = new Fuse(allProducts, {
          keys: ["name"],
          threshold: 0.4,
          ignoreLocation: true,
        });
        searchInput.addEventListener("input", () => {
          const term = searchInput.value.trim().toLowerCase();
          if (!term) {
            allProducts.forEach((prod) => {
              prod.element.style.visibility = "visible";
              prod.element.style.opacity = "1";
            });
            // Show all product headers and grids
            document
              .querySelectorAll(".productHeader")
              .forEach((header) => (header.style.display = "block"));
            document
              .querySelectorAll(".product-cards")
              .forEach((grid) => (grid.style.display = "grid"));
            return;
          }
          const results = fuse.search(term);
          const matched = new Set(results.map((r) => r.item.element));
          allProducts.forEach((prod) => {
            prod.element.style.visibility = matched.has(prod.element)
              ? "visible"
              : "hidden";
            prod.element.style.opacity = matched.has(prod.element) ? "1" : "0";
          });
          // Hide section headers and grids if no visible cards in them
          document.querySelectorAll(".productHeader").forEach((header, i) => {
            const grid = header.nextElementSibling;
            if (!grid) return;
            const visibleCards = grid.querySelectorAll(".card");
            const hasVisible = Array.from(visibleCards).some(
              (c) => c.style.visibility === "visible"
            );
            header.style.display = hasVisible ? "block" : "none";
            grid.style.display = hasVisible ? "grid" : "none";
          });
        });
      }

      // --- INITIAL RENDER ---
      function mainCollectionsInit() {
        renderCollections(candleCollections);
        updateCart();
        attachCartButtons();
        attachExpandCards();
        setupSearch();
      }
      // On DOMContentLoaded (in case script is in <body>)
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", mainCollectionsInit);
      } else {
        mainCollectionsInit();
      }
    </script>
</script>
<!-- --- CONSOLIDATED CART LOGIC WITH ACCURATE COUNT DISPLAY --- -->
<script>
// --- CONSOLIDATED CART LOGIC WITH ACCURATE COUNT DISPLAY ---
let cart = JSON.parse(localStorage.getItem("cart")) || [];
const navCartCount = document.getElementById("nav-cart-count");
function cartTotalCount() {
  return cart.reduce((sum, item) => sum + (item.qty || 1), 0);
}
function updateCart() {
  if (navCartCount) {
    navCartCount.textContent = cartTotalCount();
  }
  localStorage.setItem("cart", JSON.stringify(cart));
}
function addToCart(name, price) {
  // Add to cart logic: increment qty if exists, else add new
  const existing = cart.find((item) => item.name === name);
  if (existing) {
    existing.qty = (existing.qty || 1) + 1;
  } else {
    cart.push({ name, price, qty: 1 });
  }
  // Save cart and update count badge immediately
  localStorage.setItem("cart", JSON.stringify(cart));
  updateCart();
}
function attachCartButtons() {
  // Only attach add-to-cart logic to modal add-to-cart button, not view-details buttons
  const modalAddBtn = document.querySelector(".candle-modal-addcart");
  if (modalAddBtn && !modalAddBtn._cartHandlerAttached) {
    modalAddBtn._cartHandlerAttached = true;
    modalAddBtn.addEventListener("click", function (e) {
      e.preventDefault();
      // Use modal's data attributes
      const modal = modalAddBtn.closest(".candle-modal");
      if (!modal) return;
      const name = modal.dataset.candleName;
      const price = parseFloat(modal.dataset.candlePrice) || 0;
      addToCart(name, price);
      // Show brief confirmation animation (change button text to "Added!" for 1s)
      const originalText = modalAddBtn.textContent;
      modalAddBtn.textContent = "Added!";
      modalAddBtn.disabled = true;
      setTimeout(() => {
        modalAddBtn.textContent = originalText;
        modalAddBtn.disabled = false;
      }, 1000);
    });
  }
  // Attach to product card add-to-cart buttons
  document.querySelectorAll(".card-button.add-to-cart").forEach((btn) => {
    if (!btn._cartHandlerAttached) {
      btn._cartHandlerAttached = true;
      btn.addEventListener("click", function (e) {
        e.preventDefault();
        const card = btn.closest(".card");
        if (!card) return;
        const candleInfo = JSON.parse(card.dataset.candleInfo || "{}");
        if (candleInfo.name && candleInfo.price) {
          addToCart(candleInfo.name, candleInfo.price);
          btn.textContent = "Added!";
          btn.disabled = true;
          setTimeout(() => {
            btn.textContent = "Add to Cart";
            btn.disabled = false;
          }, 1000);
        }
      });
    }
  });
}
// Export addToCart globally for modal and dynamic elements
window.addToCart = addToCart;
window.addEventListener("storage", (event) => {
  if (event.key === "cart") {
    cart = JSON.parse(localStorage.getItem("cart")) || [];
    updateCart();
  }
});
</script>
  </body>
</html>
